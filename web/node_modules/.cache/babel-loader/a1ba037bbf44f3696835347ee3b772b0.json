{"ast":null,"code":"var _jsxFileName = \"/Users/macbook/login-react/Login-Auth-JWT/web/src/context/auth.js\";\nimport React, { useContext, createContext } from 'react';\nimport { useEffect } from 'react';\nimport { useState } from 'react';\nimport api from '../services/api';\nexport const AuthContext = createContext({\n  signed: false\n});\nexport function AuthProvider({\n  children\n}) {\n  const [user, setUser] = useState('');\n  useEffect(() => {\n    const storagedUser = JSON.parse(localStorage.getItem(\"user\"));\n    const storagedToken = localStorage.getItem(\"token\");\n\n    if (storagedUser && storagedToken) {\n      api.defaults.headers['Authorization'] = `Bearer ${storagedToken}`;\n      setUser(storagedUser);\n    }\n  }, []);\n\n  async function signIn(email, senha) {\n    api.post('/login', {\n      email,\n      senha\n    }).then(res => {\n      localStorage.setItem(\"user\", JSON.stringify(res.data.user));\n      localStorage.setItem(\"token\", res.data.token);\n      api.defaults.headers['authorization'] = `Bearer ${res.data.token}`;\n      setUser(res.data.user);\n    }).catch(err => alert(\"Senha ou email errados\"));\n  }\n\n  function logOut() {\n    localStorage.clear();\n    setUser(null);\n  }\n\n  return /*#__PURE__*/React.createElement(AuthContext.Provider, {\n    value: {\n      signed: !!user,\n      user,\n      signIn,\n      logOut\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 9\n    }\n  }, children);\n}\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  return context;\n}","map":{"version":3,"sources":["/Users/macbook/login-react/Login-Auth-JWT/web/src/context/auth.js"],"names":["React","useContext","createContext","useEffect","useState","api","AuthContext","signed","AuthProvider","children","user","setUser","storagedUser","JSON","parse","localStorage","getItem","storagedToken","defaults","headers","signIn","email","senha","post","then","res","setItem","stringify","data","token","catch","err","alert","logOut","clear","useAuth","context"],"mappings":";AAAA,OAAOA,KAAP,IAAcC,UAAd,EAAyBC,aAAzB,QAA6C,OAA7C;AACA,SAASC,SAAT,QAA0B,OAA1B;AACA,SAASC,QAAT,QAAyB,OAAzB;AACA,OAAOC,GAAP,MAAgB,iBAAhB;AACA,OAAO,MAAMC,WAAW,GAACJ,aAAa,CAAC;AAACK,EAAAA,MAAM,EAAC;AAAR,CAAD,CAA/B;AACP,OAAO,SAASC,YAAT,CAAsB;AAACC,EAAAA;AAAD,CAAtB,EAAiC;AACpC,QAAM,CAACC,IAAD,EAAMC,OAAN,IAAeP,QAAQ,CAAC,EAAD,CAA7B;AACAD,EAAAA,SAAS,CAAC,MAAI;AACV,UAAMS,YAAY,GAACC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAnB;AACA,UAAMC,aAAa,GAACF,YAAY,CAACC,OAAb,CAAqB,OAArB,CAApB;;AACA,QAAGJ,YAAY,IAAEK,aAAjB,EAA+B;AAC/BZ,MAAAA,GAAG,CAACa,QAAJ,CAAaC,OAAb,CAAqB,eAArB,IAAuC,UAASF,aAAc,EAA9D;AACIN,MAAAA,OAAO,CAACC,YAAD,CAAP;AACH;AACJ,GAPQ,EAOP,EAPO,CAAT;;AAQA,iBAAeQ,MAAf,CAAsBC,KAAtB,EAA4BC,KAA5B,EAAkC;AAC9BjB,IAAAA,GAAG,CAACkB,IAAJ,CAAS,QAAT,EAAkB;AACdF,MAAAA,KADc;AACRC,MAAAA;AADQ,KAAlB,EAEOE,IAFP,CAEYC,GAAG,IAAE;AACTV,MAAAA,YAAY,CAACW,OAAb,CAAqB,MAArB,EAA4Bb,IAAI,CAACc,SAAL,CAAeF,GAAG,CAACG,IAAJ,CAASlB,IAAxB,CAA5B;AACAK,MAAAA,YAAY,CAACW,OAAb,CAAqB,OAArB,EAA6BD,GAAG,CAACG,IAAJ,CAASC,KAAtC;AACAxB,MAAAA,GAAG,CAACa,QAAJ,CAAaC,OAAb,CAAqB,eAArB,IAAuC,UAASM,GAAG,CAACG,IAAJ,CAASC,KAAM,EAA/D;AACAlB,MAAAA,OAAO,CAACc,GAAG,CAACG,IAAJ,CAASlB,IAAV,CAAP;AACH,KAPL,EAOOoB,KAPP,CAOaC,GAAG,IAAEC,KAAK,CAAC,wBAAD,CAPvB;AAQH;;AACD,WAASC,MAAT,GAAiB;AACblB,IAAAA,YAAY,CAACmB,KAAb;AACAvB,IAAAA,OAAO,CAAC,IAAD,CAAP;AACH;;AACD,sBACI,oBAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAE;AAACJ,MAAAA,MAAM,EAAC,CAAC,CAACG,IAAV;AAAeA,MAAAA,IAAf;AAAoBU,MAAAA,MAApB;AAA2Ba,MAAAA;AAA3B,KAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACKxB,QADL,CADJ;AAKH;AACD,OAAO,SAAS0B,OAAT,GAAkB;AACrB,QAAMC,OAAO,GAACnC,UAAU,CAACK,WAAD,CAAxB;AACA,SAAO8B,OAAP;AACH","sourcesContent":["import React,{useContext,createContext} from 'react'\r\nimport { useEffect } from 'react'\r\nimport { useState } from 'react'\r\nimport api from '../services/api'\r\nexport const AuthContext=createContext({signed:false})\r\nexport function AuthProvider({children}){\r\n    const [user,setUser]=useState('')\r\n    useEffect(()=>{\r\n        const storagedUser=JSON.parse(localStorage.getItem(\"user\"))\r\n        const storagedToken=localStorage.getItem(\"token\")\r\n        if(storagedUser&&storagedToken){\r\n        api.defaults.headers['Authorization']=`Bearer ${storagedToken}`\r\n            setUser(storagedUser)\r\n        }\r\n    },[])\r\n    async function signIn(email,senha){\r\n        api.post('/login',{\r\n            email,senha\r\n            }).then(res=>{\r\n                localStorage.setItem(\"user\",JSON.stringify(res.data.user))\r\n                localStorage.setItem(\"token\",res.data.token)\r\n                api.defaults.headers['authorization']=`Bearer ${res.data.token}`\r\n                setUser(res.data.user)\r\n            }).catch(err=>alert(\"Senha ou email errados\"))\r\n    }\r\n    function logOut(){\r\n        localStorage.clear()\r\n        setUser(null)\r\n    }\r\n    return (\r\n        <AuthContext.Provider value={{signed:!!user,user,signIn,logOut}}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    )\r\n}\r\nexport function useAuth(){\r\n    const context=useContext(AuthContext)\r\n    return context\r\n}"]},"metadata":{},"sourceType":"module"}